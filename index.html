<!--?xml version="1.0" encoding="UTF-8" ?-->
<!DOCTYPE html>
<html lang="en">
	<head>
		<meta http-equiv="content-type" content="text/html; charset=UTF-8">
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title></title>
		<!-- Bootstrap -->
		<link href="resources/css/prism.css" rel="stylesheet">
		<link href="resources/subscribers/Kastanje/css/subscriber.css" rel="stylesheet">
		<!-- local  css -->
		<style type="text/css">
			ul.compact {
				list-style-position: inside;
				margin: 0;
				padding: 0;
			}
		</style>
		<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
		<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
		<!--[if lt IE 9]>
		<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
		<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
		<![endif]-->
	</head>
	<body class="with-navbar-top stretch">
		<!--[if lt IE 7]>
		<p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.</p>
		<![endif]-->
		<div class="navbar navbar-inverse navbar-fixed-top">
			<i id="appSpinner" class="spinner" style="display: none;"></i>
			<div class="container">
				<div class="navbar-header">
					<button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
					</button>
					<a class="navbar-brand" href="#"><span class="logo"></span></a>
				</div> <!-- .navbar-header -->
				<div class="navbar-collapse collapse">
					<ul id="topMenu" class="nav navbar-nav">
						<li id="topMenu_Home"><a href="#">Home</a></li>
						<li id="topMenu_Contractors"><a href="#">Aannemers</a></li>
						<li id="topMenu_Management" class="dropdown hidden">
							<a data-toggle="dropdown" class="dropdown-toggle" href="#">Beheer <b class="caret"></b></a>
							<ul role="menu" class="dropdown-menu">
								<li><a href="#">Plattegronden</a></li>
								<li><a href="#">Documenten</a></li>
							</ul>
						</li>
						<li id="topMenu_SystemManagement" class="dropdown active">
							<a data-toggle="dropdown" class="dropdown-toggle" href="#">Systeembeheer <b class="caret"></b></a>
							<ul role="menu" class="dropdown-menu">
								<li><a href="#">Portaal</a></li>
								<li><a href="#">Formulieren</a></li>
								<li><a href="#">Vastgoed</a></li>
								<li><a href="#">Register</a></li>
							</ul>
						</li>
					</ul>
					<ul class="nav navbar-nav navbar-right status">
						<li class="dropdown">
							<a href="#" class="dropdown-toggle" data-toggle="dropdown">
							<i class="fa fa-user fa-fw"></i>
							tech
							<span class="caret"></span>
							</a>
							<ul class="dropdown-menu" role="menu">
								<li><a href="#">Mijn Profiel</a></li>
								<li><a href="#">Uitloggen</a></li>
							</ul>
						</li>
					</ul>
				</div> <!-- .navbar-collapse -->
			</div> <!-- .container -->
		</div>
		<!-- .navbar -->
		<div class="main-intro"> </div>
		<div class="container">
			<div class="main-content">
				<div class="content-area">
					<div class="breadcrumb-row">
						<ul class="breadcrumb">
							<li>
								<a href="#">Home</a>
							</li>
							<li>
								<a href="#">Beheer Formulieren</a>
							</li>
							<li class="active">Formulier details</li>
							<li class="no-separator pull-right" style="display: none;">
								<a href="index.html" id="back-to-detail" class="btn btn-default btn-sm no-padding-top-bottom">
									<i class="fa fa-reply fa-lg"></i>
								</a>
							</li>
						</ul>
					</div>

					<div id="detailDiv" class="panel panel-forms">
						<div class="panel-heading clearfix">
							<strong>Formulier details</strong>
							<div class="pull-right">
								<a href="javascript:;" id="rulesBtn" class="btn btn-default btn-sm">Business rules</a>
								<a href="javascript:;" id="editBtn" class="btn btn-default btn-sm">Bewerken</a>
							</div>
						</div>
						<div class="panel-body padding">
							<div class="row">
								<strong class="col-md-2">Naam</strong>
								<div class="col-md-10">Test kastanje intern formulier</div>
							</div>
							<div class="row">
								<strong class="col-md-2">Omschrijving</strong>
								<div class="col-md-10">Test formulier</div>
							</div>
							<div class="row">
								<strong class="col-md-2">Status</strong>
								<div class="col-md-10">In gebruik</div>
							</div>
							<div class="row">
								<strong class="col-md-2">Laatste mutatie</strong>
								<div class="col-md-10">06-10-2015 12:00</div>
							</div>
							<div class="row">
								<strong class="col-md-2">Versie</strong>
								<div class="col-md-10">1</div>
							</div>
						</div> <!-- .panel-body -->
					</div> <!-- detailDiv -->

					<form novalidate="true" id="editForm" role="form">
						<input name="id" value="11" id="formId" type="hidden">
						<div id="editDiv" class="panel panel-forms form-horizontal" style="display: none;">
							<div class="panel-heading">
								<strong>Formulier details</strong>
							</div>
							<div class="panel-body">
								<div class="form-group form-group-compact form-inline">
									<div class="col-sm-2">
										<label for="inputName" class="control-label">Naam</label>
										<i class="mandatory"></i>
									</div>
									<div class="col-md-10">
										<input name="dto.name" size="50" value="Test kastanje intern formulier" id="inputName" class="form-control input-sm" data-error="Dit is een verplicht veld" required="true" type="text">
										<div class="help-block with-errors"></div>
									</div>
								</div>
								<div class="form-group form-group-compact form-inline">
									<div class="col-sm-2">
										<label for="inputDescription" class="control-label">Omschrijving</label>
										<i class="mandatory"></i>
									</div>
									<div class="col-md-10">
										<input name="dto.description" size="50" value="Test formulier" id="inputDescription" class="form-control input-sm" data-error="Dit is een verplicht veld" required="true" type="text">
										<div class="help-block with-errors"></div>
									</div>
								</div>
								<div class="form-group form-group-compact form-inline">
									<div class="col-sm-2">
										<label for="inputStatus" class="control-label">Status</label>
									</div>
									<div class="col-md-10">
										<select name="priorityInternals" id="inputStatus" class="form-control input-sm">
											<option value="PUBLISHED" selected="selected">In gebruik</option>
											<option value="CLOSED">Vervallen</option>
										</select>
									</div>
								</div>
							</div> <!-- .panel-body -->
							<div class="panel-footer text-right padding">
								<button style="pointer-events: all; cursor: pointer;" type="submit" id="btnSubmit" class="btn btn-primary btn-sm">Opslaan</button>
							</div> <!-- .panel-footer -->
						</div> <!-- editDiv -->
					</form> <!-- editForm -->

					<div id="rulesDiv" class="panel panel-forms">
						<div class="panel-heading clearfix">
							<strong>Business rules</strong>
						</div>
						<table class="table table-condensed table-hover">
							<thead>
								<tr>
									<th class="col-sm-2">Trigger</th>
									<th class="col-sm-3">Parameter</th>
									<th class="col-sm-1">Operatie</th>
									<th class="col-sm-2">Waarde</th>
									<th class="col-sm-3">Acties</th>
									<th class="col-sm-1">Combinatie</th>
								</tr>
							</thead>
							<tbody id="rulesTbl">
								<tr class="pointer">
									<td>Periodiek 30min</td>
									<td>Wat doet het niet?</td>
									<td>==</td>
									<td>waarde #4</td>
									<td>
										<ul class="compact">
											<li>actie #2</li>
											<li>actie #4</li>
										</ul>

									</td>
									<td></td>
								</tr>
								<tr class="pointer">
									<td>Vast 12:30</td>
									<td>Datum aanmaak</td>
									<td>>&gt;=</td>
									<td>12-10-2015</td>
									<td>
										<ul class="compact">
											<li>actie #1</li>
										</ul>

									</td>
									<td></td>
								</tr>
								<tr class="ruleDefinitionRow" style="display: none;">
									<td>
										<select class="triggerSelect form-control input-sm">
											<option value="trigPeriod">Periodiek</option>
											<option value="trigFixed">Vast tijdstip</option>
											<option value="trigSave">Opslaan</option>
											<option value="trigStatusChange">Statuswijzing</option>
										</select>
										<div class="trigParams trigPeriod">
											<select class="form-control input-sm">
												<option>15 min</option>
												<option>30 min</option>
												<option>60 min</option>
												<option>12 uur</option>
												<option>Dagelijks</option>
												<option>Wekelijks</option>
												<option>Maandelijks</option>
											</select>
										</div>
										<div class="trigParams trigFixed" style="display: none;">
											<input type="text" class="form-control input-sm" value="12:30">
										</div>
										<div class="trigParams trigStatusChange" style="display: none;">
											<input type="text" class="form-control input-sm" value="status #2">
										</div>
									</td>
									<td>
										<div>
											<select class="paramEntitySelect form-control input-sm">
												<option value="">Kies formulier veld...</option>
												<option value="1">Wat is het onderwerp van uw klacht?</option>
												<option value="2">Welk onderdeel betreft het?</option>
												<option value="3">Wat doet het niet</option>
											</select>
										</div>
										<div>
											<select class="paramItemSelect form-control input-sm">
												<option value="">Kies item veld...</option>
												<option value="1">Datum aanmaak</option>
												<option value="2">Status</option>
											</select>
										</div>
									</td>
									<td>
										<select class="operationSelect form-control input-sm">
											<option value="">==</option>
											<option value="">!=</option>
											<option value="">&lt;</option>
											<option value="">&lt;=</option>
											<option value="">&gt;</option>
											<option value="">&gt;=</option>
										</select>
									</td>
									<td>
										<div class="paramValue valueSelect">
											<select id="valueSelect" class="form-control input-sm">
												<option value="">Kies...</option>
												<option value="waarde #1">waarde #1</option>
												<option value="waarde #1">waarde #2</option>
												<option value="waarde #1">waarde #3</option>
												<option value="waarde #1">waarde #4</option>
												<option value="waarde #1">waarde #5</option>
											</select>
										</div>
										<div class="paramValue valueInput" style="display: none;">
											<input id="valueInput" class="form-control input-sm">
										</div>
									</td>
									<td class="pos-relative" style="padding-right: 30px;">
										<div>
											<select class="actionSelect form-control input-sm">
												<option value="">Kies...</option>
												<option value="actie1">actie #1</option>
												<option value="actie2">actie #2</option>
												<option value="actie3">actie #3</option>
												<option value="actie4">actie #4</option>
												<option value="actie5">actie #5</option>
											</select>
											<a href="javascript:;" class="actionAdd btn btn-sm" style="position: absolute; right: 0px; top: 5px;"><i class="fa fa-plus"></i></a>
										</div>

										<ul class="actionList compact"></ul>
									</td>
									<td>
										<select class="combinationSelect form-control input-sm">
											<option value=""></option>
											<option value="&amp;&amp;">&amp;&amp;</option>
											<option value="||">||</option>
										</select>
									</td>
								</tr>
							</tbody>
						</table>
					</div>

				</div> <!-- .content-area -->
			</div> <!-- .main-content -->
		</div> <!-- .container -->
		<div class="footer">
			<footer>
				<p>
					<span class="pull-left"><a href="#faq">Faq</a></span>
					Â© <a target="_blank" href="http://www.yourrequest.nl/" class="targetblank">YourRequest</a> 2015
				</p>
			</footer>
		</div> <!-- footer -->

		<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
		<script src="resources/js/jquery-min.js"></script>
		<!-- Include all compiled plugins (below), or include individual files as needed -->
		<script src="resources/js/bootstrap.min.js"></script>
		<script src="resources/js/toastr.min.js"></script>
		<script src="resources/js/tools.js"></script>
		<!-- menu script -->
		<script type="text/javascript">
			//<![CDATA[
				//Highlight topmenu item
				var YRMNU = YRMNU ? YRMNU : {
					activateTopmenuItem: function(id) {
						$('#topMenu>li').each(function(i, el) {
							$(el).removeClass('active');
						});
						$(id).addClass('active');
					}
				};
			//]]>
		</script>
		<!-- local script to bottom -->
		<script type="text/javascript">
			//<![CDATA[

			(function() {

				function toggleDetail() {
					$('#detailDiv, #rulesDiv, #editDiv').toggle('slow');
					$('#back-to-detail').parent().toggle();
				}

				function handleTriggerSelectChange($el) {
					var $td = $el.closest('td');
					$td.find('.trigParams').hide();
					$td.find('.' + $el.val()).show();
				}

				function handleParamEntitySelectChange($el) {
					var $td = $el.closest('td');
					$td.find('.paramItemSelect').val('');
					$td.find('.valueSelect').show();
					$td.find('.valueInput').hide();
				}

				function handleParamItemSelectChange($el) {
					var $td = $el.closest('td');
					$td.find('.paramEntitySelect').val('');
					$td.find('.valueInput').show();
					$td.find('.valueSelect').hide();
				}

				function handleActionAdd($el) {
					var $td = $el.closest('td');
					var $sel = $td.find('.actionSelect');
					var txt = $sel.find('option:selected').text();
					if ($sel.val()) {
						$td.find('.actionList').append(
							'<li data-action="'
							+ $sel.val()
							+ '" class="pos-relative" >'
							+ txt
							+ '<a href="javascript:;" class="actionDel btn btn-sm" style="position: absolute; right: -30px; top: -5px;"><i class="fa fa-minus"></i></a>'
							+ '</li>');
						$sel.val('');
					}
				}

				function handleActionDel($el) {
					var $li = $el.closest('li');
					$li.remove();
				}

				function handleCombinationSelectChange($el) {
					var $row = $el.closest('tr');
					if ($el.val()) {
						//&& of || gekozen
						//Alleen als het de laatste is
						if ($row.next('.ruleDefinitionRow').length == 0) {
							$row.find('.actionList').children().remove();
							var $row2 = $row.clone();
							//row2 initialiseren naar begin staat!!!!!
							//!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
							//
							// $row2.find('.actionList').children().remove();
							$row2.insertAfter($row);
						}
					} else {
						//Dit is de laatste
						////Alle volgende rijen verwijderen
						$row.next('.ruleDefinitionRow').remove();
					}
				}

				function initRuleDefinition($row) {
					var $rows = $('.ruleDefinitionRow').hide().each(function(index) {
						// console.log(index);
						if (index > 0) {
							$(this).remove();
						}
					});
					console.log($('.ruleDefinitionRow'))
					// $row.insertAfter($('.ruleDefinitionRow'));
					$('.ruleDefinitionRow').insertAfter($row).show();
				}

				$(function() {

					YRMNU.activateTopmenuItem('#topMenu_SystemManagement');

					$('#editBtn').on('click', function() {
						toggleDetail();
					});

					$('#editForm').on('submit', function(event) {
						event.preventDefault();
						location.href='index.html';
					});

					$('#rulesBtn').on('click', function() {
						toggleRules();
					});

					$('#rulesTbl').on('click', function(event) {
						var $el = $(event.target);
						var $row = $el.closest('tr');
						// console.log($row);
						if ($row.hasClass('ruleDefinitionRow')) {
							if ($el.parent().hasClass('actionAdd') || $el.hasClass('actionAdd')) {
								handleActionAdd($el);
							} else if ($el.parent().hasClass('actionDel') || $el.hasClass('actionDel')) {
								handleActionDel($el);
							}
						} else {
							initRuleDefinition($row);
						}
					});

					$('#rulesTbl').on('change', function(event) {
						var $el = $(event.target);
						if ($el.hasClass('triggerSelect')) {
							handleTriggerSelectChange($el);
						} else if ($el.hasClass('paramEntitySelect')) {
							handleParamEntitySelectChange($el);
						} else if ($el.hasClass('paramItemSelect')) {
							handleParamItemSelectChange($el);
						} else if ($el.hasClass('combinationSelect')) {
							handleCombinationSelectChange($el);
						}
					});


				});

			})();

			//]]>
		</script>
	</body>
</html>